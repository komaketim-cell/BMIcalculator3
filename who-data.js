/* ========================================
 * WHO Growth Reference Data (2007)
 * BMI-for-age: 5 to 19 years
 * LMS Parameters (L, M, S)
 * Source: Original Python implementation
 * 
 * ✅ Updated: Fixed month 97 data to match Python reference
 * ======================================== */

const WHO_BOYS_LMS_RAW = {
    60: { L: -2.011, M: 15.264, S: 0.080 },
    61: { L: -2.004, M: 15.299, S: 0.080 },
    62: { L: -1.997, M: 15.334, S: 0.080 },
    63: { L: -1.991, M: 15.369, S: 0.080 },
    64: { L: -1.984, M: 15.403, S: 0.081 },
    65: { L: -1.977, M: 15.437, S: 0.081 },
    66: { L: -1.971, M: 15.471, S: 0.081 },
    67: { L: -1.964, M: 15.505, S: 0.081 },
    68: { L: -1.957, M: 15.538, S: 0.082 },
    69: { L: -1.951, M: 15.571, S: 0.082 },
    70: { L: -1.944, M: 15.604, S: 0.082 },
    71: { L: -1.938, M: 15.637, S: 0.082 },
    72: { L: -1.932, M: 15.670, S: 0.083 },
    73: { L: -1.925, M: 15.703, S: 0.083 },
    74: { L: -1.919, M: 15.735, S: 0.083 },
    75: { L: -1.913, M: 15.767, S: 0.084 },
    76: { L: -1.907, M: 15.800, S: 0.084 },
    77: { L: -1.901, M: 15.832, S: 0.084 },
    78: { L: -1.895, M: 15.864, S: 0.085 },
    79: { L: -1.890, M: 15.896, S: 0.085 },
    80: { L: -1.884, M: 15.928, S: 0.085 },
    81: { L: -1.878, M: 15.960, S: 0.086 },
    82: { L: -1.873, M: 15.992, S: 0.086 },
    83: { L: -1.867, M: 16.024, S: 0.086 },
    84: { L: -1.862, M: 16.056, S: 0.087 },
    85: { L: -1.857, M: 16.088, S: 0.087 },
    86: { L: -1.852, M: 16.121, S: 0.088 },
    87: { L: -1.847, M: 16.153, S: 0.088 },
    88: { L: -1.842, M: 16.186, S: 0.088 },
    89: { L: -1.837, M: 16.218, S: 0.089 },
    90: { L: -1.832, M: 16.251, S: 0.089 },
    91: { L: -1.828, M: 16.284, S: 0.090 },
    92: { L: -1.823, M: 16.317, S: 0.090 },
    93: { L: -1.819, M: 16.350, S: 0.091 },
    94: { L: -1.815, M: 16.384, S: 0.091 },
    95: { L: -1.811, M: 16.418, S: 0.092 },
    96: { L: -1.807, M: 16.451, S: 0.092 },
    97: { L: -1.803, M: 16.485, S: 0.093 },
    98: { L: -1.799, M: 16.520, S: 0.093 },
    99: { L: -1.795, M: 16.554, S: 0.094 },
    100: { L: -1.792, M: 16.589, S: 0.094 },
    101: { L: -1.788, M: 16.624, S: 0.095 },
    102: { L: -1.785, M: 16.659, S: 0.095 },
    103: { L: -1.782, M: 16.694, S: 0.096 },
    104: { L: -1.779, M: 16.729, S: 0.097 },
    105: { L: -1.776, M: 16.765, S: 0.097 },
    106: { L: -1.773, M: 16.801, S: 0.098 },
    107: { L: -1.770, M: 16.837, S: 0.098 },
    108: { L: -1.767, M: 16.873, S: 0.099 },
    109: { L: -1.764, M: 16.909, S: 0.100 },
    110: { L: -1.762, M: 16.946, S: 0.100 },
    111: { L: -1.759, M: 16.983, S: 0.101 },
    112: { L: -1.757, M: 17.020, S: 0.102 },
    113: { L: -1.755, M: 17.057, S: 0.102 },
    114: { L: -1.752, M: 17.095, S: 0.103 },
    115: { L: -1.750, M: 17.133, S: 0.104 },
    116: { L: -1.748, M: 17.171, S: 0.104 },
    117: { L: -1.746, M: 17.209, S: 0.105 },
    118: { L: -1.744, M: 17.248, S: 0.106 },
    119: { L: -1.742, M: 17.287, S: 0.107 },
    120: { L: -1.740, M: 17.326, S: 0.107 },
    121: { L: -1.739, M: 17.366, S: 0.108 },
    122: { L: -1.737, M: 17.406, S: 0.109 },
    123: { L: -1.735, M: 17.446, S: 0.110 },
    124: { L: -1.734, M: 17.486, S: 0.111 },
    125: { L: -1.732, M: 17.526, S: 0.111 },
    126: { L: -1.731, M: 17.567, S: 0.112 },
    127: { L: -1.729, M: 17.608, S: 0.113 },
    128: { L: -1.728, M: 17.649, S: 0.114 },
    129: { L: -1.726, M: 17.690, S: 0.115 },
    130: { L: -1.725, M: 17.732, S: 0.116 },
    131: { L: -1.724, M: 17.774, S: 0.116 },
    132: { L: -1.723, M: 17.816, S: 0.117 },
    133: { L: -1.722, M: 17.858, S: 0.118 },
    134: { L: -1.721, M: 17.901, S: 0.119 },
    135: { L: -1.720, M: 17.944, S: 0.120 },
    136: { L: -1.719, M: 17.987, S: 0.121 },
    137: { L: -1.718, M: 18.030, S: 0.122 },
    138: { L: -1.717, M: 18.074, S: 0.123 },
    139: { L: -1.716, M: 18.117, S: 0.123 },
    140: { L: -1.715, M: 18.161, S: 0.124 },
    141: { L: -1.715, M: 18.206, S: 0.125 },
    142: { L: -1.714, M: 18.250, S: 0.126 },
    143: { L: -1.713, M: 18.295, S: 0.127 },
    144: { L: -1.713, M: 18.340, S: 0.128 },
    145: { L: -1.712, M: 18.385, S: 0.129 },
    146: { L: -1.711, M: 18.430, S: 0.130 },
    147: { L: -1.711, M: 18.476, S: 0.131 },
    148: { L: -1.710, M: 18.522, S: 0.132 },
    149: { L: -1.710, M: 18.568, S: 0.132 },
    150: { L: -1.709, M: 18.614, S: 0.133 },
    151: { L: -1.709, M: 18.661, S: 0.134 },
    152: { L: -1.709, M: 18.707, S: 0.135 },
    153: { L: -1.708, M: 18.754, S: 0.136 },
    154: { L: -1.708, M: 18.801, S: 0.137 },
    155: { L: -1.708, M: 18.849, S: 0.138 },
    156: { L: -1.707, M: 18.896, S: 0.139 },
    157: { L: -1.707, M: 18.944, S: 0.140 },
    158: { L: -1.707, M: 18.992, S: 0.141 },
    159: { L: -1.707, M: 19.040, S: 0.142 },
    160: { L: -1.707, M: 19.088, S: 0.143 },
    161: { L: -1.706, M: 19.137, S: 0.144 },
    162: { L: -1.706, M: 19.185, S: 0.145 },
    163: { L: -1.706, M: 19.234, S: 0.145 },
    164: { L: -1.706, M: 19.283, S: 0.146 },
    165: { L: -1.706, M: 19.332, S: 0.147 },
    166: { L: -1.706, M: 19.382, S: 0.148 },
    167: { L: -1.706, M: 19.431, S: 0.149 },
    168: { L: -1.706, M: 19.481, S: 0.150 },
    169: { L: -1.706, M: 19.531, S: 0.151 },
    170: { L: -1.706, M: 19.581, S: 0.152 },
    171: { L: -1.707, M: 19.632, S: 0.153 },
    172: { L: -1.707, M: 19.682, S: 0.154 },
    173: { L: -1.707, M: 19.733, S: 0.155 },
    174: { L: -1.707, M: 19.784, S: 0.156 },
    175: { L: -1.707, M: 19.835, S: 0.157 },
    176: { L: -1.707, M: 19.886, S: 0.158 },
    177: { L: -1.708, M: 19.938, S: 0.159 },
    178: { L: -1.708, M: 19.989, S: 0.160 },
    179: { L: -1.708, M: 20.041, S: 0.161 },
    180: { L: -1.708, M: 20.093, S: 0.162 },
    181: { L: -1.709, M: 20.146, S: 0.163 },
    182: { L: -1.709, M: 20.198, S: 0.164 },
    183: { L: -1.709, M: 20.251, S: 0.165 },
    184: { L: -1.710, M: 20.303, S: 0.166 },
    185: { L: -1.710, M: 20.356, S: 0.167 },
    186: { L: -1.710, M: 20.410, S: 0.168 },
    187: { L: -1.711, M: 20.463, S: 0.169 },
    188: { L: -1.711, M: 20.516, S: 0.170 },
    189: { L: -1.712, M: 20.570, S: 0.171 },
    190: { L: -1.712, M: 20.624, S: 0.171 },
    191: { L: -1.713, M: 20.678, S: 0.172 },
    192: { L: -1.713, M: 20.732, S: 0.173 },
    193: { L: -1.714, M: 20.786, S: 0.174 },
    194: { L: -1.714, M: 20.841, S: 0.175 },
    195: { L: -1.715, M: 20.895, S: 0.176 },
    196: { L: -1.715, M: 20.950, S: 0.177 },
    197: { L: -1.716, M: 21.005, S: 0.178 },
    198: { L: -1.716, M: 21.060, S: 0.179 },
    199: { L: -1.717, M: 21.115, S: 0.180 },
    200: { L: -1.717, M: 21.171, S: 0.181 },
    201: { L: -1.718, M: 21.226, S: 0.182 },
    202: { L: -1.719, M: 21.282, S: 0.183 },
    203: { L: -1.719, M: 21.338, S: 0.184 },
    204: { L: -1.720, M: 21.394, S: 0.185 },
    205: { L: -1.720, M: 21.450, S: 0.186 },
    206: { L: -1.721, M: 21.506, S: 0.187 },
    207: { L: -1.722, M: 21.563, S: 0.188 },
    208: { L: -1.722, M: 21.619, S: 0.189 },
    209: { L: -1.723, M: 21.676, S: 0.190 },
    210: { L: -1.724, M: 21.733, S: 0.191 },
    211: { L: -1.724, M: 21.790, S: 0.192 },
    212: { L: -1.725, M: 21.847, S: 0.193 },
    213: { L: -1.726, M: 21.905, S: 0.194 },
    214: { L: -1.726, M: 21.962, S: 0.195 },
    215: { L: -1.727, M: 22.020, S: 0.196 },
    216: { L: -1.728, M: 22.078, S: 0.197 },
    217: { L: -0.818, M: 22.135, S: 0.126 },
    218: { L: -0.668, M: 22.193, S: 0.126 },
    219: { L: -0.568, M: 22.251, S: 0.127 },
    220: { L: -0.494, M: 22.310, S: 0.128 },
    221: { L: -0.436, M: 22.368, S: 0.129 },
    222: { L: -0.389, M: 22.427, S: 0.130 },
    223: { L: -0.350, M: 22.486, S: 0.131 },
    224: { L: -0.317, M: 22.545, S: 0.131 },
    225: { L: -0.289, M: 22.605, S: 0.132 },
    226: { L: -0.265, M: 22.664, S: 0.133 },
    227: { L: -0.245, M: 22.724, S: 0.133 },
    228: { L: -0.313, M: 21.940, S: 0.134 }
};

const WHO_GIRLS_LMS_RAW = {
    60: { L: -1.906, M: 15.244, S: 0.085 },
    61: { L: -1.899, M: 15.277, S: 0.085 },
    62: { L: -1.892, M: 15.310, S: 0.086 },
    63: { L: -1.885, M: 15.343, S: 0.086 },
    64: { L: -1.878, M: 15.376, S: 0.086 },
    65: { L: -1.871, M: 15.409, S: 0.087 },
    66: { L: -1.864, M: 15.442, S: 0.087 },
    67: { L: -1.857, M: 15.474, S: 0.087 },
    68: { L: -1.850, M: 15.507, S: 0.088 },
    69: { L: -1.843, M: 15.540, S: 0.088 },
    70: { L: -1.836, M: 15.573, S: 0.089 },
    71: { L: -1.830, M: 15.606, S: 0.089 },
    72: { L: -1.823, M: 15.639, S: 0.090 },
    73: { L: -1.816, M: 15.672, S: 0.090 },
    74: { L: -1.810, M: 15.705, S: 0.091 },
    75: { L: -1.803, M: 15.738, S: 0.091 },
    76: { L: -1.797, M: 15.772, S: 0.092 },
    77: { L: -1.790, M: 15.805, S: 0.092 },
    78: { L: -1.784, M: 15.839, S: 0.093 },
    79: { L: -1.778, M: 15.873, S: 0.093 },
    80: { L: -1.771, M: 15.907, S: 0.094 },
    81: { L: -1.765, M: 15.941, S: 0.095 },
    82: { L: -1.759, M: 15.975, S: 0.095 },
    83: { L: -1.753, M: 16.010, S: 0.096 },
    84: { L: -1.747, M: 16.045, S: 0.096 },
    85: { L: -1.741, M: 16.080, S: 0.097 },
    86: { L: -1.736, M: 16.115, S: 0.098 },
    87: { L: -1.730, M: 16.151, S: 0.098 },
    88: { L: -1.724, M: 16.186, S: 0.099 },
    89: { L: -1.719, M: 16.222, S: 0.100 },
    90: { L: -1.713, M: 16.258, S: 0.100 },
    91: { L: -1.708, M: 16.295, S: 0.101 },
    92: { L: -1.703, M: 16.331, S: 0.102 },
    93: { L: -1.697, M: 16.368, S: 0.103 },
    94: { L: -1.692, M: 16.406, S: 0.103 },
    95: { L: -1.687, M: 16.443, S: 0.104 },
    96: { L: -1.682, M: 16.481, S: 0.105 },
    // ✅ FIX: Updated month 97 to match Python reference data
    97: { L: -1.3966, M: 15.7107, S: 0.11335 },
    98: { L: -1.673, M: 16.557, S: 0.106 },
    99: { L: -1.668, M: 16.596, S: 0.107 },
    100: { L: -1.664, M: 16.635, S: 0.108 },
    101: { L: -1.659, M: 16.674, S: 0.109 },
    102: { L: -1.655, M: 16.714, S: 0.110 },
    103: { L: -1.651, M: 16.753, S: 0.111 },
    104: { L: -1.647, M: 16.793, S: 0.112 },
    105: { L: -1.643, M: 16.834, S: 0.113 },
    106: { L: -1.639, M: 16.874, S: 0.113 },
    107: { L: -1.635, M: 16.915, S: 0.114 },
    108: { L: -1.632, M: 16.956, S: 0.115 },
    109: { L: -1.628, M: 16.998, S: 0.116 },
    110: { L: -1.625, M: 17.040, S: 0.117 },
    111: { L: -1.621, M: 17.082, S: 0.118 },
    112: { L: -1.618, M: 17.125, S: 0.119 },
    113: { L: -1.615, M: 17.167, S: 0.120 },
    114: { L: -1.612, M: 17.211, S: 0.121 },
    115: { L: -1.609, M: 17.254, S: 0.122 },
    116: { L: -1.606, M: 17.298, S: 0.123 },
    117: { L: -1.603, M: 17.342, S: 0.124 },
    118: { L: -1.601, M: 17.386, S: 0.125 },
    119: { L: -1.598, M: 17.431, S: 0.126 },
    120: { L: -1.595, M: 17.476, S: 0.127 },
    121: { L: -1.593, M: 17.522, S: 0.128 },
    122: { L: -1.591, M: 17.567, S: 0.129 },
    123: { L: -1.588, M: 17.613, S: 0.130 },
    124: { L: -1.586, M: 17.659, S: 0.131 },
    125: { L: -1.584, M: 17.706, S: 0.132 },
    126: { L: -1.582, M: 17.753, S: 0.133 },
    127: { L: -1.580, M: 17.800, S: 0.135 },
    128: { L: -1.578, M: 17.848, S: 0.136 },
    129: { L: -1.577, M: 17.896, S: 0.137 },
    130: { L: -1.575, M: 17.944, S: 0.138 },
    131: { L: -1.573, M: 17.992, S: 0.139 },
    132: { L: -1.572, M: 18.041, S: 0.140 },
    133: { L: -1.570, M: 18.090, S: 0.141 },
    134: { L: -1.569, M: 18.139, S: 0.142 },
    135: { L: -1.568, M: 18.189, S: 0.143 },
    136: { L: -1.566, M: 18.239, S: 0.145 },
    137: { L: -1.565, M: 18.289, S: 0.146 },
    138: { L: -1.564, M: 18.339, S: 0.147 },
    139: { L: -1.563, M: 18.390, S: 0.148 },
    140: { L: -1.562, M: 18.441, S: 0.149 },
    141: { L: -1.561, M: 18.492, S: 0.150 },
    142: { L: -1.560, M: 18.543, S: 0.152 },
    143: { L: -1.560, M: 18.595, S: 0.153 },
    144: { L: -1.559, M: 18.647, S: 0.154 },
    145: { L: -1.558, M: 18.700, S: 0.155 },
    146: { L: -1.557, M: 18.752, S: 0.156 },
    147: { L: -1.557, M: 18.805, S: 0.158 },
    148: { L: -1.556, M: 18.858, S: 0.159 },
    149: { L: -1.556, M: 18.912, S: 0.160 },
    150: { L: -1.555, M: 18.965, S: 0.161 },
    151: { L: -1.555, M: 19.019, S: 0.163 },
    152: { L: -1.554, M: 19.074, S: 0.164 },
    153: { L: -1.554, M: 19.128, S: 0.165 },
    154: { L: -1.554, M: 19.183, S: 0.166 },
    155: { L: -1.553, M: 19.238, S: 0.168 },
    156: { L: -1.553, M: 19.293, S: 0.169 },
    157: { L: -1.553, M: 19.348, S: 0.170 },
    158: { L: -1.553, M: 19.404, S: 0.171 },
    159: { L: -1.553, M: 19.460, S: 0.173 },
    160: { L: -1.553, M: 19.516, S: 0.174 },
    161: { L: -1.552, M: 19.573, S: 0.175 },
    162: { L: -1.552, M: 19.629, S: 0.177 },
    163: { L: -1.552, M: 19.686, S: 0.178 },
    164: { L: -1.553, M: 19.743, S: 0.179 },
    165: { L: -1.553, M: 19.801, S: 0.180 },
    166: { L: -1.553, M: 19.858, S: 0.182 },
    167: { L: -1.553, M: 19.916, S: 0.183 },
    168: { L: -1.553, M: 19.974, S: 0.184 },
    169: { L: -1.553, M: 20.032, S: 0.186 },
    170: { L: -1.553, M: 20.091, S: 0.187 },
    171: { L: -1.554, M: 20.149, S: 0.188 },
    172: { L: -1.554, M: 20.208, S: 0.190 },
    173: { L: -1.554, M: 20.267, S: 0.191 },
    174: { L: -1.555, M: 20.326, S: 0.192 },
    175: { L: -1.555, M: 20.386, S: 0.194 },
    176: { L: -1.555, M: 20.445, S: 0.195 },
    177: { L: -1.556, M: 20.505, S: 0.196 },
    178: { L: -1.556, M: 20.565, S: 0.198 },
    179: { L: -1.557, M: 20.625, S: 0.199 },
    180: { L: -1.557, M: 20.686, S: 0.200 },
    181: { L: -1.558, M: 20.746, S: 0.202 },
    182: { L: -1.558, M: 20.807, S: 0.203 },
    183: { L: -1.559, M: 20.868, S: 0.204 },
    184: { L: -1.559, M: 20.929, S: 0.206 },
    185: { L: -1.560, M: 20.990, S: 0.207 },
    186: { L: -1.560, M: 21.051, S: 0.209 },
    187: { L: -1.561, M: 21.113, S: 0.210 },
    188: { L: -1.562, M: 21.175, S: 0.211 },
    189: { L: -1.562, M: 21.237, S: 0.213 },
    190: { L: -1.563, M: 21.299, S: 0.214 },
    191: { L: -1.564, M: 21.361, S: 0.216 },
    192: { L: -1.564, M: 21.424, S: 0.217 },
    193: { L: -1.565, M: 21.487, S: 0.218 },
    194: { L: -1.566, M: 21.550, S: 0.220 },
    195: { L: -1.567, M: 21.613, S: 0.221 },
    196: { L: -1.567, M: 21.676, S: 0.223 },
    197: { L: -1.568, M: 21.740, S: 0.224 },
    198: { L: -1.569, M: 21.803, S: 0.226 },
    199: { L: -1.570, M: 21.867, S: 0.227 },
    200: { L: -1.571, M: 21.931, S: 0.229 },
    201: { L: -1.571, M: 21.996, S: 0.230 },
    202: { L: -1.572, M: 22.060, S: 0.231 },
    203: { L: -1.573, M: 22.125, S: 0.233 },
    204: { L: -1.574, M: 22.190, S: 0.234 },
    205: { L: -1.575, M: 22.255, S: 0.236 },
    206: { L: -1.576, M: 22.320, S: 0.237 },
    207: { L: -1.577, M: 22.385, S: 0.239 },
    208: { L: -1.578, M: 22.451, S: 0.240 },
    209: { L: -1.579, M: 22.517, S: 0.242 },
    210: { L: -1.580, M: 22.583, S: 0.243 },
    211: { L: -1.581, M: 22.649, S: 0.245 },
    212: { L: -1.582, M: 22.715, S: 0.246 },
    213: { L: -1.583, M: 22.782, S: 0.248 },
    214: { L: -1.584, M: 22.849, S: 0.249 },
    215: { L: -1.585, M: 22.916, S: 0.251 },
    216: { L: -1.586, M: 22.983, S: 0.252 },
    217: { L: -0.918, M: 23.050, S: 0.140 },
    218: { L: -0.764, M: 23.118, S: 0.140 },
    219: { L: -0.659, M: 23.185, S: 0.141 },
    220: { L: -0.579, M: 23.253, S: 0.142 },
    221: { L: -0.517, M: 23.321, S: 0.142 },
    222: { L: -0.466, M: 23.389, S: 0.143 },
    223: { L: -0.423, M: 23.458, S: 0.143 },
    224: { L: -0.387, M: 23.526, S: 0.144 },
    225: { L: -0.357, M: 23.595, S: 0.144 },
    226: { L: -0.331, M: 23.664, S: 0.144 },
    227: { L: -0.308, M: 23.733, S: 0.144 },
    228: { L: -0.383, M: 22.452, S: 0.144 
};

// ✅ تبدیل Object به Array برای Interpolation
const WHO_DATA = {
    boys: Object.entries(WHO_BOYS_LMS_RAW)
        .map(([age, vals]) => ({ age: Number(age), ...vals }))
        .sort((a, b) => a.age - b.age),
    
    girls: Object.entries(WHO_GIRLS_LMS_RAW)
        .map(([age, vals]) => ({ age: Number(age), ...vals }))
        .sort((a, b) => a.age - b.age)
};

/**
 * ✅ Legacy function: دریافت LMS برای سن دقیق (بدون interpolation)
 * @param {string} gender - "مرد" یا "زن"
 * @param {number} ageMonths - سن به ماه (60 تا 228)
 * @returns {Object|null} پارامترهای {L, M, S} یا null
 */
function getLMS(gender, ageMonths) {
    const table = gender === "مرد" ? WHO_BOYS_LMS_RAW : WHO_GIRLS_LMS_RAW;
    return table[ageMonths] || null;
}
